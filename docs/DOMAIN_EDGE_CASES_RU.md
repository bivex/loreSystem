# –ü—Ä–æ–≤–µ—Ä–∫–∞ –î–æ–º–µ–Ω–∞ –∏ Edge Cases –¥–ª—è –õ–æ—Ä-–°–∏—Å—Ç–µ–º—ã

**–î–∞—Ç–∞**: 2026-01-18  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –ü—Ä–æ–¥–∞–∫—à–Ω—É  
**–Ø–∑—ã–∫**: –†—É—Å—Å–∫–∏–π / Russian

## –ö—Ä–∞—Ç–∫–æ–µ –û–ø–∏—Å–∞–Ω–∏–µ

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç –≤—Å–µ edge cases (–≥—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏) –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—é –¥–æ–º–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ –¥–ª—è gacha RPG –ª–æ—Ä-—Å–∏—Å—Ç–µ–º—ã. –í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É—é—Ç, —á—Ç–æ —Å–∏—Å—Ç–µ–º–∞ –Ω–µ —Ä–∞–∑–≤–∞–ª–∏—Ç—Å—è –≤ –ø—Ä–æ–¥–∞–∫—à–Ω–µ –∏ –±—É–¥–µ—Ç –ø–æ–Ω—è—Ç–Ω–∞ –∏–≥—Ä–æ–∫–∞–º.

## –û—Å–Ω–æ–≤–Ω—ã–µ –ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã –î–æ–º–µ–Ω–∞

### 1. –ú–∏—Ä (World)

**–ë–∏–∑–Ω–µ—Å-–ü—Ä–∞–≤–∏–ª–∞:**
- ‚úÖ –ò–º—è –º–∏—Ä–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö —Ç–µ–Ω–∞–Ω—Ç–∞
- ‚úÖ –í–µ—Ä—Å–∏—è —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –º–æ–Ω–æ—Ç–æ–Ω–Ω–æ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è—Ö
- ‚úÖ –î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è >= –¥–∞—Ç—ã —Å–æ–∑–¥–∞–Ω–∏—è
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –º–∏—Ä–æ–≤ (parent_id)

**Edge Cases:**
```python
# ‚úÖ –í–∞–ª–∏–¥–Ω—ã–π –º–∏—Ä
world = World.create(
    tenant_id=TenantId(1),
    name=WorldName("–¢—ë–º–Ω—ã–µ –ó–µ–º–ª–∏ –≠—Ä–µ–±–∞"),
    description=Description("–ú—Ä–∞—á–Ω—ã–π –º–∏—Ä..."),
)

# ‚ùå –ù–µ–≤–∞–ª–∏–¥–Ω–æ: updated_at < created_at
# –≠—Ç–æ –ø–æ–π–º–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
```

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –≤ —Ç–µ—Å—Ç–∞—Ö:**
- `test_world_updated_timestamp_validation` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–∫
- `test_world_hierarchical_parent_validation` - –∏–µ—Ä–∞—Ä—Ö–∏—è –º–∏—Ä–æ–≤
- `test_world_version_monotonic_increase` - –º–æ–Ω–æ—Ç–æ–Ω–Ω–æ–µ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–∏

---

### 2. –ü–µ—Ä—Å–æ–Ω–∞–∂ (Character)

**–ë–∏–∑–Ω–µ—Å-–ü—Ä–∞–≤–∏–ª–∞:**
- ‚úÖ –ë—ç–∫—Å—Ç–æ—Ä–∏ >= 100 —Å–∏–º–≤–æ–ª–æ–≤ (–∏–≥—Ä–æ–∫–∞–º –Ω—É–∂–Ω–∞ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è!)
- ‚úÖ –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π (–Ω–µ–ª—å–∑—è –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å)
- ‚úÖ –í—Å–µ –±–æ–µ–≤—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ >= 0 (HP, ATK, DEF, Speed)
- ‚úÖ –£—Ä–æ–≤–µ–Ω—å —Å–∏–ª—ã —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π: 1-10
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–µ–¥–∫–æ—Å—Ç–∏ (COMMON, RARE, EPIC, LEGENDARY, MYTHIC)
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ (Fire, Water, Earth, Wind, Light, Dark)
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–æ–ª–µ–π (DPS, Tank, Support, Specialist)

**Edge Cases –¥–ª—è –ò–≥—Ä–æ–∫–æ–≤:**

#### –†–µ–¥–∫–æ—Å—Ç—å –∏ –°—Ç–∞—Ç—ã
```python
# ‚úÖ SSR –ø–µ—Ä—Å–æ–Ω–∞–∂ (LEGENDARY) —Å –ø–æ–ª–Ω—ã–º–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º–∏
lira = Character.create(
    tenant_id=TenantId(1),
    world_id=EntityId(1),
    name=CharacterName("–õ–∏—Ä–∞ –ö—Ä–æ–≤–∞–≤—ã–π –®—ë–ø–æ—Ç"),
    backstory=Backstory("..." * 150),  # –ò–Ω—Ç–µ—Ä–µ—Å–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è
    rarity=Rarity.LEGENDARY,
    element=CharacterElement.DARK,
    role=CharacterRole.DPS,
    base_hp=3000,      # –ó–¥–æ—Ä–æ–≤—å–µ
    base_atk=900,      # –ê—Ç–∞–∫–∞ (–≤—ã—Å–æ–∫–∞—è –¥–ª—è DPS)
    base_def=200,      # –ó–∞—â–∏—Ç–∞ (–Ω–∏–∑–∫–∞—è –¥–ª—è DPS)
    base_speed=110,    # –°–∫–æ—Ä–æ—Å—Ç—å
    energy_cost=80,    # –°—Ç–æ–∏–º–æ—Å—Ç—å —É–ª—å—Ç–∏–º–µ–π—Ç–∞
)

# ‚ùå –ù–µ–≤–∞–ª–∏–¥–Ω–æ: –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ —Å—Ç–∞—Ç—ã
# –ü–æ–π–º–∞–µ—Ç—Å—è InvariantViolation
Character.create(..., base_hp=-100)  # –û–®–ò–ë–ö–ê!
```

#### –°–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
```python
# ‚úÖ –ü–µ—Ä—Å–æ–Ω–∞–∂ —Å 3 —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—è–º–∏
abilities = [
    Ability(
        name=AbilityName("–ö—Ä–æ–≤–∞–≤—ã–π –®—ë–ø–æ—Ç"),
        description="–ì–æ–ª–æ—Å, –∑–∞—Å—Ç–∞–≤–ª—è—é—â–∏–π –≤—Ä–∞–≥–æ–≤ –∏—Å—Ç–µ–∫–∞—Ç—å –∫—Ä–æ–≤—å—é",
        power_level=PowerLevel(9)  # 1-10
    ),
    Ability(
        name=AbilityName("–¢–µ–Ω–µ–≤–æ–π –°–∫–∞—á–æ–∫"),
        description="–ú–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ —á–µ—Ä–µ–∑ —Ç–µ–Ω–∏",
        power_level=PowerLevel(8)
    ),
]

# ‚ùå –ù–µ–≤–∞–ª–∏–¥–Ω–æ: –¥—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è –∏–º–µ–Ω–∞ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π
# –ü–æ–π–º–∞–µ—Ç—Å—è InvariantViolation
abilities = [
    Ability(name="Fireball", ...),
    Ability(name="Fireball", ...),  # –û–®–ò–ë–ö–ê! –î—É–±–ª–∏–∫–∞—Ç
]
```

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –≤ —Ç–µ—Å—Ç–∞—Ö:**
- `test_character_backstory_minimum_length` - –º–∏–Ω–∏–º—É–º 100 —Å–∏–º–≤–æ–ª–æ–≤ –±—ç–∫—Å—Ç–æ—Ä–∏
- `test_character_duplicate_abilities_rejected` - –Ω–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π
- `test_character_combat_stats_non_negative` - –Ω–µ–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ —Å—Ç–∞—Ç—ã
- `test_character_rarity_and_role_validation` - —Ä–µ–¥–∫–æ—Å—Ç—å –∏ —Ä–æ–ª—å –¥–ª—è gacha
- `test_character_ability_power_level_bounds` - —É—Ä–æ–≤–µ–Ω—å —Å–∏–ª—ã 1-10
- `test_character_average_power_calculation` - —Å—Ä–µ–¥–Ω—è—è —Å–∏–ª–∞ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π

---

### 3. –°–æ–±—ã—Ç–∏—è (Event)

**–ë–∏–∑–Ω–µ—Å-–ü—Ä–∞–≤–∏–ª–∞:**
- ‚úÖ –ú–∏–Ω–∏–º—É–º 1 —É—á–∞—Å—Ç–Ω–∏–∫ (–Ω–µ—Ç –ø—É—Å—Ç—ã—Ö —Å–æ–±—ã—Ç–∏–π!)
- ‚úÖ –ù–µ—Ç –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö—Å—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
- ‚úÖ –ù–µ–ª—å–∑—è —É–¥–∞–ª–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞
- ‚úÖ –î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è > –¥–∞—Ç—ã –Ω–∞—á–∞–ª–∞
- ‚úÖ –ò–º—è —Å–æ–±—ã—Ç–∏—è: –Ω–µ –ø—É—Å—Ç–æ–µ, <= 255 —Å–∏–º–≤–æ–ª–æ–≤
- ‚úÖ –í–∞–ª–∏–¥–Ω—ã–µ –∏—Å—Ö–æ–¥—ã: SUCCESS, FAILURE, ONGOING

**Edge Cases –¥–ª—è –ò–≥—Ä–æ–∫–æ–≤:**

```python
# ‚úÖ –í–∞–ª–∏–¥–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ (–±–∏—Ç–≤–∞)
event = Event.create(
    tenant_id=TenantId(1),
    world_id=EntityId(1),
    name="–ë–∏—Ç–≤–∞ –¢–µ–Ω–µ–π",
    description=Description("–≠–ø–∏—á–µ—Å–∫–∞—è –±–∏—Ç–≤–∞ –º–µ–∂–¥—É –≥–µ—Ä–æ—è–º–∏"),
    start_date=Timestamp.now(),
    participant_ids=[EntityId(3), EntityId(4)],  # –õ–∏—Ä–∞ –∏ –í–∏–∫—Ç–æ—Ä
    outcome=EventOutcome.ONGOING,
)

# ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è
event.complete(
    end_date=Timestamp(datetime.now() + timedelta(hours=2)),
    outcome=EventOutcome.SUCCESS  # –ì–µ—Ä–æ–∏ –ø–æ–±–µ–¥–∏–ª–∏!
)

# ‚ùå –ù–µ–≤–∞–ª–∏–¥–Ω–æ: –Ω–µ—Ç —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
Event.create(..., participant_ids=[])  # –û–®–ò–ë–ö–ê!

# ‚ùå –ù–µ–≤–∞–ª–∏–¥–Ω–æ: –¥—É–±–ª–∏–∫–∞—Ç—ã —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
Event.create(..., participant_ids=[EntityId(1), EntityId(1)])  # –û–®–ò–ë–ö–ê!

# ‚ùå –ù–µ–≤–∞–ª–∏–¥–Ω–æ: –Ω–µ–ª—å–∑—è —É–¥–∞–ª–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞
solo_event = Event.create(..., participant_ids=[EntityId(1)])
solo_event.remove_participant(EntityId(1))  # –û–®–ò–ë–ö–ê!
```

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –≤ —Ç–µ—Å—Ç–∞—Ö:**
- `test_event_must_have_participants` - –º–∏–Ω–∏–º—É–º 1 —É—á–∞—Å—Ç–Ω–∏–∫
- `test_event_duplicate_participants_rejected` - –Ω–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
- `test_event_cannot_remove_last_participant` - –∑–∞—â–∏—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞
- `test_event_completion_validation` - –≤–∞–ª–∏–¥–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
- `test_event_date_range_validation` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞—Ç
- `test_event_name_validation` - –≤–∞–ª–∏–¥–∞—Ü–∏—è –∏–º–µ–Ω–∏

---

### 4. –ë–∞–Ω–Ω–µ—Ä (Banner) - Gacha –ú–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è

**–ë–∏–∑–Ω–µ—Å-–ü—Ä–∞–≤–∏–ª–∞:**
- ‚úÖ –®–∞–Ω—Å—ã –≤—ã–ø–∞–¥–µ–Ω–∏—è —Å—É–º–º–∏—Ä—É—é—Ç—Å—è –≤ 100% (SSR + SR + R = 100%)
- ‚úÖ SSR rate: 0-10% (–æ–±—ã—á–Ω–æ 0.6%)
- ‚úÖ SR rate: 0-50% (–æ–±—ã—á–Ω–æ 5.1%)
- ‚úÖ –°—Ç–æ–∏–º–æ—Å—Ç—å –ø—É–ª–æ–≤ > 0
- ‚úÖ 10-–ø—É–ª <= 10 √ó —Å—Ç–æ–∏–º–æ—Å—Ç—å –æ–¥–∏–Ω–æ—á–Ω–æ–≥–æ –ø—É–ª–∞ (–æ–±—ã—á–Ω–æ —Å–∫–∏–¥–∫–∞)
- ‚úÖ –ü–æ—Ä—è–¥–æ–∫ pity: soft < hard < featured_guarantee
- ‚úÖ –î–ª—è –ª–∏–º–∏—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –±–∞–Ω–Ω–µ—Ä–æ–≤: end_date > start_date

**Edge Cases –¥–ª—è –ò–≥—Ä–æ–∫–æ–≤:**

#### –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ë–∞–Ω–Ω–µ—Ä (Permanent)
```python
# ‚úÖ –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –±–∞–Ω–Ω–µ—Ä —Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏ —à–∞–Ω—Å–∞–º–∏
standard = Banner.create_standard_banner(
    tenant_id=TenantId(1),
    name="–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –ñ–µ–ª–∞–Ω–∏–µ",
    description=Description("–ü–æ—Å—Ç–æ—è–Ω–Ω—ã–π –±–∞–Ω–Ω–µ—Ä —Å–æ –≤—Å–µ–º–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞–º–∏"),
)

# –®–∞–Ω—Å—ã:
# - SSR (5‚òÖ): 0.6%
# - SR (4‚òÖ): 5.1%
# - R (3‚òÖ): 94.3%
# –°—É–º–º–∞ = 100% ‚úÖ

# Pity —Å–∏—Å—Ç–µ–º–∞:
# - Soft pity: 75 –ø—É–ª–æ–≤ (—à–∞–Ω—Å —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è)
# - Hard pity: 90 –ø—É–ª–æ–≤ (–≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π SSR)
# - Featured guarantee: 180 –ø—É–ª–æ–≤ (–≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π featured SSR)
```

#### –õ–∏–º–∏—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ë–∞–Ω–Ω–µ—Ä
```python
# ‚úÖ –õ–∏–º–∏—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –±–∞–Ω–Ω–µ—Ä —Å featured –ø–µ—Ä—Å–æ–Ω–∞–∂–∞–º–∏
limited = Banner.create_limited_banner(
    tenant_id=TenantId(1),
    name="–õ–∏—Ä–∞: –ö—Ä–æ–≤–∞–≤–∞—è –õ—É–Ω–∞",
    description=Description("Rate-up –¥–ª—è –õ–∏—Ä—ã!"),
    featured_character_ids=[EntityId(3)],  # –õ–∏—Ä–∞
    start_date=datetime.now(),
    duration_days=21,  # 3 –Ω–µ–¥–µ–ª–∏
)

# Featured rate: 50% (50/50 —Å–∏—Å—Ç–µ–º–∞)
# –ü—Ä–∏ –≤—ã–ø–∞–¥–µ–Ω–∏–∏ SSR:
# - 50% —à–∞–Ω—Å –ø–æ–ª—É—á–∏—Ç—å featured –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ (–õ–∏—Ä—É)
# - 50% —à–∞–Ω—Å –ø–æ–ª—É—á–∏—Ç—å –ª—é–±–æ–≥–æ –¥—Ä—É–≥–æ–≥–æ SSR
# - –ï—Å–ª–∏ –ø—Ä–æ–∏–≥—Ä–∞–ª 50/50, —Å–ª–µ–¥—É—é—â–∏–π SSR –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ featured
```

#### –†–∞—Å—á—ë—Ç –°—Ç–æ–∏–º–æ—Å—Ç–∏
```python
# –†–∞—Å—á—ë—Ç –≥–µ–º–º–æ–≤ –¥–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ SSR
banner = Banner.create_standard_banner(...)

# –î–æ hard pity (90 –ø—É–ª–æ–≤)
cost = banner.calculate_total_cost_for_pity("hard")
# = 9 √ó 1600 = 14,400 –≥–µ–º–º–æ–≤ (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ —á–µ—Ä–µ–∑ 10-–ø—É–ª—ã)

# –î–æ featured guarantee (180 –ø—É–ª–æ–≤)
cost = banner.calculate_total_cost_for_pity("featured")
# = 18 √ó 1600 = 28,800 –≥–µ–º–º–æ–≤
```

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –≤ —Ç–µ—Å—Ç–∞—Ö:**
- `test_banner_drop_rates_must_sum_to_100` - —à–∞–Ω—Å—ã = 100%
- `test_banner_pity_thresholds_validation` - –ø–æ—Ä—è–¥–æ–∫ pity –ø–æ—Ä–æ–≥–æ–≤
- `test_banner_pull_cost_validation` - –≤–∞–ª–∏–¥–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø—É–ª–æ–≤
- `test_banner_limited_date_validation` - –¥–∞—Ç—ã –ª–∏–º–∏—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –±–∞–Ω–Ω–µ—Ä–æ–≤
- `test_banner_ssr_rate_bounds` - SSR rate –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö 0-10%
- `test_banner_cost_calculation_for_pity` - —Ä–∞—Å—á—ë—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏

---

### 5. Pity –°–∏—Å—Ç–µ–º–∞ - –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ì–∞—Ä–∞–Ω—Ç–∏–π

**–ë–∏–∑–Ω–µ—Å-–ü—Ä–∞–≤–∏–ª–∞:**
- ‚úÖ –°—á—ë—Ç—á–∏–∫–∏ pity >= 0 (–Ω–µ –º–æ–≥—É—Ç –±—ã—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º–∏)
- ‚úÖ –°—á—ë—Ç—á–∏–∫ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –≤ 0 –ø—Ä–∏ –≤—ã–ø–∞–¥–µ–Ω–∏–∏ SSR
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ 50/50: –µ—Å–ª–∏ –Ω–µ –≤—ã–ø–∞–ª featured, —Å–ª–µ–¥—É—é—â–∏–π –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ featured
- ‚úÖ –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –ø—É–ª–æ–≤

**Edge Cases –¥–ª—è –ò–≥—Ä–æ–∫–æ–≤:**

#### –°—á—ë—Ç—á–∏–∫ Pity
```python
# ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ pity tracker –¥–ª—è –∏–≥—Ä–æ–∫–∞
pity = Pity.create(
    tenant_id=TenantId(1),
    player_id="player-uuid-123",
    profile_id=EntityId(5),
    banner_id=EntityId(101),
)

# –ù–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:
# - pulls_since_last_ssr = 0
# - pulls_since_last_featured = 0
# - guaranteed_featured_next = False

# –°–∏–º—É–ª—è—Ü–∏—è 89 –ø—É–ª–æ–≤ –±–µ–∑ SSR
for i in range(89):
    pity.record_pull(is_ssr=False)

assert pity.pulls_since_last_ssr == 89
assert pity.is_at_soft_pity(75)  # True (–º—ã –Ω–∞ soft pity!)
assert not pity.is_at_hard_pity(90)  # False (–µ—â—ë 1 –ø—É–ª –¥–æ hard pity)
```

#### –°–∏—Å—Ç–µ–º–∞ 50/50
```python
# –ò–≥—Ä–æ–∫ –ø–æ–ª—É—á–∞–µ—Ç SSR –Ω–∞ 90-–º –ø—É–ª–µ (hard pity)
pity.record_pull(is_ssr=True, is_featured=False)

# –†–µ–∑—É–ª—å—Ç–∞—Ç:
# - pulls_since_last_ssr = 0 (—Å–±—Ä–æ—à–µ–Ω–æ!)
# - pulls_since_last_featured = 1 (–Ω–µ featured)
# - guaranteed_featured_next = True (—Å–ª–µ–¥—É—é—â–∏–π SSR –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ featured!)
# - total_ssr_pulled = 1

# –ò–≥—Ä–æ–∫ –¥–µ–ª–∞–µ—Ç –µ—â—ë –ø—É–ª—ã...
for i in range(90):
    pity.record_pull(is_ssr=False)

# –ü–æ–ª—É—á–∞–µ—Ç SSR –Ω–∞ 90-–º –ø—É–ª–µ —Å–Ω–æ–≤–∞
pity.record_pull(is_ssr=True, is_featured=True)

# –†–µ–∑—É–ª—å—Ç–∞—Ç:
# - pulls_since_last_ssr = 0
# - pulls_since_last_featured = 0 (—Å–±—Ä–æ—à–µ–Ω–æ!)
# - guaranteed_featured_next = False (–≥–∞—Ä–∞–Ω—Ç–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞)
# - total_featured_pulled = 1
```

#### –ü—Ä–æ–≤–µ—Ä–∫–∏ –ü–æ—Ä–æ–≥–æ–≤
```python
# –°–∫–æ–ª—å–∫–æ –ø—É–ª–æ–≤ –¥–æ hard pity?
remaining = pity.pulls_until_hard_pity(90)
print(f"–î–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ SSR: {remaining} –ø—É–ª–æ–≤")

# –°–∫–æ–ª—å–∫–æ –ø—É–ª–æ–≤ –¥–æ featured guarantee?
remaining = pity.pulls_until_featured_guarantee(180)
print(f"–î–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ featured: {remaining} –ø—É–ª–æ–≤")

# –î–æ—Å—Ç–∏–≥–ª–∏ –ª–∏ –º—ã soft pity?
if pity.is_at_soft_pity(75):
    print("–®–∞–Ω—Å SSR —É–≤–µ–ª–∏—á–µ–Ω!")
```

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –≤ —Ç–µ—Å—Ç–∞—Ö:**
- `test_pity_counters_non_negative` - —Å—á—ë—Ç—á–∏–∫–∏ >= 0
- `test_pity_counter_reset_on_ssr` - —Å–±—Ä–æ—Å –ø—Ä–∏ SSR
- `test_pity_50_50_system` - —Å–∏—Å—Ç–µ–º–∞ 50/50
- `test_pity_threshold_checks` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä–æ–≥–æ–≤
- `test_pity_reset_functionality` - —Å–±—Ä–æ—Å —Å—á—ë—Ç—á–∏–∫–æ–≤

---

### 6. –ü—Ä–µ–¥–º–µ—Ç—ã (Item)

**–ë–∏–∑–Ω–µ—Å-–ü—Ä–∞–≤–∏–ª–∞:**
- ‚úÖ –£—Ä–æ–≤–µ–Ω—å –ø—Ä–µ–¥–º–µ—Ç–∞: 1-100
- ‚úÖ –£–ª—É—á—à–µ–Ω–∏–µ (enhancement) >= 0 (–æ–±—ã—á–Ω–æ 0-20)
- ‚úÖ –í—Å–µ —Å—Ç–∞—Ç—ã >= 0 (ATK, HP, DEF)
- ‚úÖ –ò–º—è –ø—Ä–µ–¥–º–µ—Ç–∞: –Ω–µ –ø—É—Å—Ç–æ–µ, <= 255 —Å–∏–º–≤–æ–ª–æ–≤
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç–∏–ø–æ–≤: Weapon, Armor, Artifact, Consumable, Tool
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–µ–¥–∫–æ—Å—Ç–∏: Common, Rare, Epic, Legendary, Mythic

**Edge Cases –¥–ª—è –ò–≥—Ä–æ–∫–æ–≤:**

```python
# ‚úÖ –õ–µ–≥–µ–Ω–¥–∞—Ä–Ω–æ–µ –æ—Ä—É–∂–∏–µ
sword = Item.create(
    tenant_id=TenantId(1),
    world_id=EntityId(1),
    name="–ú–µ—á –°—É–¥—å–±—ã",
    description=Description("–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π –º–µ—á —Å —Ç—ë–º–Ω–æ–π —Å–∏–ª–æ–π"),
    item_type=ItemType.WEAPON,
    rarity=Rarity.LEGENDARY,
    level=90,              # –£—Ä–æ–≤–µ–Ω—å 90
    enhancement=15,        # +15 —É–ª—É—á—à–µ–Ω–∏–µ
    max_enhancement=20,    # –ú–∞–∫—Å–∏–º—É–º +20
    base_atk=500,          # +500 –∞—Ç–∞–∫–∏
    base_hp=200,           # +200 HP
    base_def=100,          # +100 –∑–∞—â–∏—Ç—ã
    special_stat="crit_rate",      # –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∞
    special_stat_value=25.5,       # +25.5% –∫—Ä–∏—Ç —à–∞–Ω—Å
)

# ‚ùå –ù–µ–≤–∞–ª–∏–¥–Ω–æ: —É—Ä–æ–≤–µ–Ω—å –≤–Ω–µ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ 1-100
Item.create(..., level=0)    # –û–®–ò–ë–ö–ê!
Item.create(..., level=101)  # –û–®–ò–ë–ö–ê!

# ‚ùå –ù–µ–≤–∞–ª–∏–¥–Ω–æ: –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ
Item.create(..., enhancement=-5)  # –û–®–ò–ë–ö–ê!
```

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –≤ —Ç–µ—Å—Ç–∞—Ö:**
- `test_item_level_bounds` - —É—Ä–æ–≤–µ–Ω—å 1-100
- `test_item_enhancement_non_negative` - —É–ª—É—á—à–µ–Ω–∏–µ >= 0
- `test_item_stats_non_negative` - —Å—Ç–∞—Ç—ã >= 0
- `test_item_name_validation` - –≤–∞–ª–∏–¥–∞—Ü–∏—è –∏–º–µ–Ω–∏

---

## –ö—Ä–æ—Å—Å-–°—É—â–Ω–æ—Å—Ç–Ω—ã–µ –ü—Ä–æ–≤–µ—Ä–∫–∏

### –ü–µ—Ä—Å–æ–Ω–∞–∂ –≤ –°–æ–±—ã—Ç–∏–∏
```python
# ‚úÖ –°–æ–±—ã—Ç–∏–µ —Å—Å—ã–ª–∞–µ—Ç—Å—è –Ω–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π
event = Event.create(
    tenant_id=TenantId(1),
    world_id=EntityId(1),
    name="–ë–∏—Ç–≤–∞ –¢–µ–Ω–µ–π",
    description=Description("–≠–ø–∏—á–µ—Å–∫–∞—è –±–∏—Ç–≤–∞"),
    start_date=Timestamp.now(),
    participant_ids=[EntityId(3), EntityId(4)],  # –õ–∏—Ä–∞ –∏ –í–∏–∫—Ç–æ—Ä
)

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
assert event.has_participant(EntityId(3))  # True (–õ–∏—Ä–∞ —É—á–∞—Å—Ç–≤—É–µ—Ç)
assert event.has_participant(EntityId(4))  # True (–í–∏–∫—Ç–æ—Ä —É—á–∞—Å—Ç–≤—É–µ—Ç)
assert not event.has_participant(EntityId(999))  # False (–Ω–µ —É—á–∞—Å—Ç–≤—É–µ—Ç)
```

### –ö–æ–º–±–∏–Ω–∞—Ü–∏–∏ –≠–ª–µ–º–µ–Ω—Ç–æ–≤ –∏ –†–æ–ª–µ–π
```python
# ‚úÖ –û–≥–Ω–µ–Ω–Ω—ã–π DPS
fire_dps = Character.create(
    ...,
    element=CharacterElement.FIRE,
    role=CharacterRole.DPS,
)

# ‚úÖ –í–æ–¥–Ω—ã–π Support (—Ü–µ–ª–∏—Ç–µ–ª—å)
water_healer = Character.create(
    ...,
    element=CharacterElement.WATER,
    role=CharacterRole.SUPPORT,
)

# –í—Å–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏ —Ä–æ–ª–µ–π –≤–∞–ª–∏–¥–Ω—ã!
```

### –ë–∞–Ω–Ω–µ—Ä —Å Featured –ü–µ—Ä—Å–æ–Ω–∞–∂–∞–º–∏
```python
# ‚úÖ –õ–∏–º–∏—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –±–∞–Ω–Ω–µ—Ä —Å featured –ø–µ—Ä—Å–æ–Ω–∞–∂–∞–º–∏
limited = Banner.create_limited_banner(
    tenant_id=TenantId(1),
    name="–õ–∏—Ä–∞: –ö—Ä–æ–≤–∞–≤–∞—è –õ—É–Ω–∞",
    description=Description("Featured: –õ–∏—Ä–∞ –ö—Ä–æ–≤–∞–≤—ã–π –®—ë–ø–æ—Ç"),
    featured_character_ids=[EntityId(3)],  # –õ–∏—Ä–∞ –Ω–∞ rate-up
    start_date=datetime.now(),
    duration_days=21,
)

# –ü—Ä–∏ pull'–µ SSR:
# - 50% —à–∞–Ω—Å –ø–æ–ª—É—á–∏—Ç—å –õ–∏—Ä—É (featured)
# - 50% —à–∞–Ω—Å –ø–æ–ª—É—á–∏—Ç—å –ª—é–±–æ–≥–æ –¥—Ä—É–≥–æ–≥–æ SSR
```

---

## –ü–æ–Ω—è—Ç–Ω–æ—Å—Ç—å –¥–ª—è –ò–≥—Ä–æ–∫–æ–≤

### –ß—Ç–æ –ò–≥—Ä–æ–∫ –í–∏–¥–∏—Ç –≤ –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ

#### 1. –ü–µ—Ä—Å–æ–Ω–∞–∂
```
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë  –õ–∏—Ä–∞ –ö—Ä–æ–≤–∞–≤—ã–π –®—ë–ø–æ—Ç (5‚òÖ LEGENDARY) ‚ïë
‚ïë  ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ  ‚ïë
‚ïë  –≠–ª–µ–º–µ–Ω—Ç: –¢—å–º–∞ (Dark)                ‚ïë
‚ïë  –†–æ–ª—å: DPS (–£—Ä–æ–Ω)                    ‚ïë
‚ïë  ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ  ‚ïë
‚ïë  HP:  3000  |  ATK: 900              ‚ïë
‚ïë  DEF: 200   |  SPD: 110              ‚ïë
‚ïë  ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ  ‚ïë
‚ïë  –°–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏:                        ‚ïë
‚ïë  ‚Ä¢ –ö—Ä–æ–≤–∞–≤—ã–π –®—ë–ø–æ—Ç (Power: 9/10)     ‚ïë
‚ïë  ‚Ä¢ –¢–µ–Ω–µ–≤–æ–π –°–∫–∞—á–æ–∫ (Power: 8/10)     ‚ïë
‚ïë  ‚Ä¢ –í–∞–º–ø–∏—Ä—Å–∫–∞—è –†–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è (7/10)    ‚ïë
‚ïë  ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ  ‚ïë
‚ïë  –°—Ä–µ–¥–Ω—è—è —Å–∏–ª–∞: 8.0/10 üî•             ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
```

#### 2. Gacha –ë–∞–Ω–Ω–µ—Ä
```
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë  üåô –õ–∏—Ä–∞: –ö—Ä–æ–≤–∞–≤–∞—è –õ—É–Ω–∞ (LIMITED)   ‚ïë
‚ïë  ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ  ‚ïë
‚ïë  –û—Å—Ç–∞–ª–æ—Å—å: 18 –¥–Ω–µ–π 5 —á–∞—Å–æ–≤          ‚ïë
‚ïë  ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ  ‚ïë
‚ïë  –®–∞–Ω—Å—ã:                              ‚ïë
‚ïë  ‚Ä¢ 5‚òÖ SSR: 0.6% (featured: 50%)     ‚ïë
‚ïë  ‚Ä¢ 4‚òÖ SR:  5.1%                     ‚ïë
‚ïë  ‚Ä¢ 3‚òÖ R:   94.3%                    ‚ïë
‚ïë  ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ  ‚ïë
‚ïë  Pity:                               ‚ïë
‚ïë  ‚Ä¢ Pulls since SSR: 75/90           ‚ïë
‚ïë  ‚Ä¢ ‚ú® Soft pity activated!          ‚ïë
‚ïë  ‚Ä¢ –î–æ –≥–∞—Ä–∞–Ω—Ç–∏–∏: 15 pulls            ‚ïë
‚ïë  ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ  ‚ïë
‚ïë  –°—Ç–æ–∏–º–æ—Å—Ç—å:                          ‚ïë
‚ïë  ‚Ä¢ 1 pull:  160 üíé gems             ‚ïë
‚ïë  ‚Ä¢ 10 pulls: 1600 üíé (—Å–∫–∏–¥–∫–∞ 0%)    ‚ïë
‚ïë  ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ  ‚ïë
‚ïë  Featured: –õ–∏—Ä–∞ –ö—Ä–æ–≤–∞–≤—ã–π –®—ë–ø–æ—Ç ‚≠ê   ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
```

#### 3. Pity Tracker
```
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë  üìä –¢–≤–æ—è Gacha –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞           ‚ïë
‚ïë  ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ  ‚ïë
‚ïë  Pulls since SSR:       75/90       ‚ïë
‚ïë  [‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë] Soft pity!  ‚ïë
‚ïë  ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ  ‚ïë
‚ïë  –î–æ hard pity: 15 pulls             ‚ïë
‚ïë  –°—Ç–æ–∏–º–æ—Å—Ç—å: ~2,400 üíé gems          ‚ïë
‚ïë  ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ  ‚ïë
‚ïë  50/50 Status:                       ‚ïë
‚ïë  ‚ö†Ô∏è –ù–ï –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω featured SSR    ‚ïë
‚ïë  (–ï—Å–ª–∏ –≤—ã–ø–∞–¥–µ—Ç SSR: 50% —à–∞–Ω—Å –õ–∏—Ä—ã)  ‚ïë
‚ïë  ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ  ‚ïë
‚ïë  –ò—Å—Ç–æ—Ä–∏—è:                            ‚ïë
‚ïë  ‚Ä¢ –í—Å–µ–≥–æ pulls: 175                 ‚ïë
‚ïë  ‚Ä¢ –ü–æ–ª—É—á–µ–Ω–æ SSR: 1                  ‚ïë
‚ïë  ‚Ä¢ Featured SSR: 0                  ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
```

---

## –ó–∞–ø—É—Å–∫ –¢–µ—Å—Ç–æ–≤

### –í—Å–µ Edge Case –¢–µ—Å—Ç—ã

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã edge cases
pytest tests/test_domain_edge_cases_comprehensive.py -v

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –∫–ª–∞—Å—Å —Ç–µ—Å—Ç–æ–≤
pytest tests/test_domain_edge_cases_comprehensive.py::TestCharacterEdgeCases -v

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ç–µ—Å—Ç
pytest tests/test_domain_edge_cases_comprehensive.py::TestBannerEdgeCases::test_banner_drop_rates_must_sum_to_100 -v
```

### –ü–æ–∫—Ä—ã—Ç–∏–µ –¢–µ—Å—Ç–∞–º–∏

–í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ edge cases –ø–æ–∫—Ä—ã—Ç—ã —Ç–µ—Å—Ç–∞–º–∏:
- ‚úÖ 6 –∫–ª–∞—Å—Å–æ–≤ —Ç–µ—Å—Ç–æ–≤
- ‚úÖ 40+ edge case —Ç–µ—Å—Ç–æ–≤
- ‚úÖ –í—Å–µ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã
- ‚úÖ –í—Å–µ –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞ –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞–Ω—ã

---

## –ì–∞—Ä–∞–Ω—Ç–∏–∏ –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏

### –ß—Ç–æ –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –°–∏—Å—Ç–µ–º–∞

1. **–¶–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –î–∞–Ω–Ω—ã—Ö**
   - –í—Å–µ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—É—â–Ω–æ—Å—Ç–µ–π
   - –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (validation –Ω–∞ —É—Ä–æ–≤–Ω–µ –¥–æ–º–µ–Ω–∞)
   - –°—Å—ã–ª–æ—á–Ω–∞—è —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å —á–µ—Ä–µ–∑ EntityId

2. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –¥–ª—è –ò–≥—Ä–æ–∫–æ–≤**
   - –®–∞–Ω—Å—ã gacha –≤—Å–µ–≥–¥–∞ —Å—É–º–º–∏—Ä—É—é—Ç—Å—è –≤ 100%
   - Pity —Å–∏—Å—Ç–µ–º–∞ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç (–Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ —Å–±—Ä–æ—Å–∏—Ç—å —Å—á—ë—Ç—á–∏–∫–∏ —Å–ª—É—á–∞–π–Ω–æ)
   - –ü–µ—Ä—Å–æ–Ω–∞–∂–∏ –≤—Å–µ–≥–¥–∞ –∏–º–µ—é—Ç –≤–∞–ª–∏–¥–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏

3. **–ü–æ–Ω—è—Ç–Ω–æ—Å—Ç—å**
   - –í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–º–µ—é—Ç —á—ë—Ç–∫–∏–µ –≥—Ä–∞–Ω–∏—Ü—ã (1-10, 1-100, >= 0)
   - –ê–Ω–≥–ª–∏–π—Å–∫–∏–µ –∏ —Ä—É—Å—Å–∫–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è –ø–æ–ª–µ–π
   - –î–µ—Ç–∞–ª—å–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö

4. **–ú–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è**
   - –ë–∞–Ω–Ω–µ—Ä—ã –Ω–µ –º–æ–≥—É—Ç –∏–º–µ—Ç—å –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —à–∞–Ω—Å—ã
   - –°—Ç–æ–∏–º–æ—Å—Ç—å pull'–æ–≤ –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞–Ω–∞
   - Pity —Å–∏—Å—Ç–µ–º–∞ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

### –°—Ç–∞—Ç—É—Å: ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –ü—Ä–æ–¥–∞–∫—à–Ω—É

–í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ edge cases –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã –∏ –ø–æ–∫—Ä—ã—Ç—ã —Ç–µ—Å—Ç–∞–º–∏. –°–∏—Å—Ç–µ–º–∞:
- ‚úÖ –ù–µ —Ä–∞–∑–≤–∞–ª–∏—Ç—Å—è –≤ –ø—Ä–æ–¥–∞–∫—à–Ω–µ
- ‚úÖ –ü–æ–Ω—è—Ç–Ω–∞ –∏–≥—Ä–æ–∫–∞–º
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–∞ –¥–ª—è –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏–∏
- ‚úÖ –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —á–µ—Å—Ç–Ω—É—é gacha —Å–∏—Å—Ç–µ–º—É
- ‚úÖ –ó–∞—â–∏—â–∞–µ—Ç –æ—Ç –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### –°–ª–µ–¥—É—é—â–∏–µ –®–∞–≥–∏

1. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
2. UI —Ç–µ—Å—Ç—ã –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–≥—Ä–æ–∫–∞–º
3. –ù–∞–≥—Ä—É–∑–æ—á–Ω—ã–µ —Ç–µ—Å—Ç—ã –¥–ª—è gacha pull'–æ–≤
4. A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π

---

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–∞**: 2026-01-18  
**–Ø–∑—ã–∫**: –†—É—Å—Å–∫–∏–π (Russian)  
**–¢–µ—Å—Ç–æ–≤–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ**: 40+ edge cases  
**–°—Ç–∞—Ç—É—Å**: Production-Ready ‚úÖ
